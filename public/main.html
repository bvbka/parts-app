<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="css/style.css" />
    <script src="js/check_session.js"></script>
    <title>Main</title>
</head>

<body>
    <div class="notifs-blocker">
        <div class="notifs-info">
            Włącz powiadomienia, aby móc korzystać z aplikacji
            <button id="enableNotifsBtn">Włącz powiadomienia</button>
            <div class="notifs-response"></div>
        </div>
    </div>
    <div class="options-container">
        <div class="options">
            <div class="option" dependentSite="actions/createTask.html">Zleć zadanie</div>
            <div class="option" dependentSite="actions/checkCreatedTasks.html">Zlecone zadania</div>
            <div class="option" dependentSite="actions/checkYourTasks.html">Zadania do wykonania</div>
            <div class="option">Opcje</div>
            <!-- <div class="option" dependentSite="test.html">DEV</div> -->
        </div>
    </div>

    <script>

        document.addEventListener('DOMContentLoaded', () => {

            const options = document.querySelectorAll('.option');

            options.forEach(option => {
                const target = option.getAttribute('dependentSite');
                if (target) {
                    option.style.cursor = 'pointer';
                    option.addEventListener('click', () => {
                        window.location.href = target;
                    });
                }
            });

            const notifsBlocker = document.querySelector('.notifs-blocker');
            const notifsResponse = document.querySelector('.notifs-response');

            if (Notification.permission === 'granted') {
                notifsBlocker.style.display = 'none';
            } else {
                notifsBlocker.style.display = 'flex';
            }

            document.getElementById('enableNotifsBtn').addEventListener('click', () => {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        notifsBlocker.style.display = 'none';
                    } else {
                        notifsResponse.style.display = 'block';
                        notifsResponse.innerHTML = 'Nie włączyłeś powiadomień. Aplikacja nie będzie działać!';
                    }
                });
            });
        });
    </script>
</body>

</html>